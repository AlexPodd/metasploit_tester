package domain

import (
	"time"
)

type ExploitFile struct {
	Subdir  string
	Name    string
	Content string
}

type Exploit struct {
	Path            string
	Name            string
	DescriptionExpl string
	Platform        string
	Authors         []string
	Targets         []string
	References      []string
}

func (e Exploit) FilterValue() string { return e.Name }
func (e Exploit) Title() string       { return e.Name }
func (e Exploit) Description() string { return e.DescriptionExpl }

type ConfigExploit struct {
	Name   string            `json:"name"`
	Params map[string]string `json:"params"`
}

type Config struct {
	Exploits []ConfigExploit `json:"exploits"`
}

type MetaSploitInterface interface {
	Run(exploitsPath []string, config ConfigExploit) (*Report, error)
	Reload() error
	Login(host, login, password string) (err error)
}

type ExploitResult struct {
	ExploitName string
	Success     bool
	Output      string
}

type Report struct {
	Timestamp time.Time
	Results   []ExploitResult
}
